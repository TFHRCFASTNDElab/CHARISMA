<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chapter 1. Introduction &mdash; CHARISMA 04/09/2024 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/style.css?v=a6eb682e" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=c8a63458"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            CHARISMA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro_charisma.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using CHARISMA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../anaconda_installation.html">Anaconda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../databricks.html">Databricks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NDE techniques</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Ground Penetrating Radar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DPS/index.html">Density Profiling System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HCP/index.html">Half Cell Potential</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ER/index.html">Electrical Resistivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../IE/index.html">Impact Echo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PAUT/index.html">Phased Array Ultrasonic Testing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../env.html">Python Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CHARISMA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Chapter 1. Introduction</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/TFHRCFASTNDElab/CHARISMA/blob/main/docs/GPR/Applications/case_study_origin.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="chapter-1-introduction">
<h1>Chapter 1. Introduction<a class="headerlink" href="#chapter-1-introduction" title="Link to this heading"></a></h1>
<section id="physical-principal">
<h2>Physical Principal<a class="headerlink" href="#physical-principal" title="Link to this heading"></a></h2>
<p>Ground Penetrating Radar (GPR) is a Non-Destructive Evaluation (NDE) technique to investigate objects or structures buried underground. The basic principle of GPR involves the transmission of electromagnetic (EM) waves with high frequencies ranging from 10 MHz to 2.6 GHz into the test subject. The EM will reflect when reaching subsurface objects that have dielectric properties different from the surrounding materials. Table 1 shows the dielectric of common materials. For concrete bridge decks, concrete has a dielectric normally around 8, while metallic rebars have a theoretically infinite dielectric. Thus, large reflections will be observed when using GPR to scan concrete bridge decks. The GPR system records the reflected signals and uses this information to identify rebars. If you want more detailed knowledge of GPR (or any other NDE techniques), click the image below to visit infotechnology.</p>
<a class="reference external image-reference" href="https://infotechnology.fhwa.dot.gov/"><img alt="infotech" src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/a8f0f1f5-160e-47f2-8254-9544174698da" style="width: 300px;" /></a>
<p>Table 1. Relative Dielectric Permittivity for Different Materials.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Material</p></th>
<th class="head"><p>Dielectric Constant</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Air</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Clay</p></td>
<td><p>25-40</p></td>
</tr>
<tr class="row-even"><td><p>Concrete</p></td>
<td><p>8-10</p></td>
</tr>
<tr class="row-odd"><td><p>Crushed base</p></td>
<td><p>6-8</p></td>
</tr>
<tr class="row-even"><td><p>Gravel</p></td>
<td><p>4-7</p></td>
</tr>
<tr class="row-odd"><td><p>Hot mix asphalt</p></td>
<td><p>4-8</p></td>
</tr>
<tr class="row-even"><td><p>Ice</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>Insulation board</p></td>
<td><p>2-2.5</p></td>
</tr>
<tr class="row-even"><td><p>Sand</p></td>
<td><p>4-6</p></td>
</tr>
<tr class="row-odd"><td><p>Silt</p></td>
<td><p>16-30</p></td>
</tr>
<tr class="row-even"><td><p>Silty sand</p></td>
<td><p>7-10</p></td>
</tr>
<tr class="row-odd"><td><p>Water (fresh)</p></td>
<td><p>81</p></td>
</tr>
</tbody>
</table>
<p>While the antenna is traveling the bridge horizontally (along the x-axis), the transmitter (Tx) of the antenna emits the electromagnetic wavelet and it penetrates through the test subject (z-axis). The reflected signal from the object in the subsurface is recorded into the receiver (Rx) of the antenna. Thus, the recorded data contains multiple reflected wavelets with respect to the distance along x. Each reflected wavelet as a function of discrete time is called an “A-scan”. “B-scan” is obtained by stitching multiple A-scans together along the survey line (x) and assigning a color (black to white) to the wave amplitude. Since the B-scan provides 2D vertical information underground, it is commonly used to analyze the system or structure. “C-scan” refers to the horizontal view of the specific horizontal layer of the subsurface. Figure 1 helps us understand the definition of each type of scan from GPR.</p>
<img alt="Beginning" src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/70f1acb4-2a15-4eae-aef6-498ec6c014fe" />
<p>Figure 1. The definition of A-, B-, and C-scan (Merkle, Frey, and Reiterer 2021).</p>
<img alt="Beginning" src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/bde0cf0b-773f-4793-8996-d585ccd7e38f" />
<p>Figure 2. GPR data acquisition on the bridge (Left) and how GPR B-scan data looks like with respect to the actual rebar configuration (Right). The horizontal axis (x-axis) of the data corresponds to the distance along the survey line (moving direction of the GPR machine), and the vertical axis (z-axis) is the depth of the ground.</p>
</section>
<section id="objectives-of-the-case-study">
<h2>Objectives of the Case Study<a class="headerlink" href="#objectives-of-the-case-study" title="Link to this heading"></a></h2>
<p>This case study aims to provide a Python-based solution to processing GPR data for rebar identification in concrete bridge decks. The case study will give a tutorial with detailed step-by-step on how to use CHARISMA for this task. The case study will first demonstrate the use of CHARISMA with GPR data collected in the Federal Highway Administration (FHWA) Non-Destructive Evaluation (NDE) Laboratory. The study will then extend the use of CHARISMA to process GPR data collected in the field, a bridge located in Mississippi.</p>
</section>
</section>
<section id="chapter-2-setup-charisma">
<h1>Chapter 2. Setup CHARISMA<a class="headerlink" href="#chapter-2-setup-charisma" title="Link to this heading"></a></h1>
<section id="installing-charisma-in-python">
<h2>Installing CHARISMA in Python<a class="headerlink" href="#installing-charisma-in-python" title="Link to this heading"></a></h2>
<p>We recommend using Anaconda to simplify the environment setup. Anaconda is commonly used for managing Python packages in user-defined environments. In other words, it allows you to create isolated environments for different projects, each with its own set of dependencies, without interfering with the system-wide Python installation. This is particularly useful in data science and scientific computing where projects may have different requirements and dependencies. Here in First, download Anaconda in the provided URL: <a class="reference external" href="https://www.anaconda.com/download">https://www.anaconda.com/download</a></p>
<p>We recommend installing our conda environment <code class="code docutils literal notranslate"><span class="pre">charisma-env</span></code> to run the code properly. This environment has all the dependencies from our entire code. Download the <code class="code docutils literal notranslate"><span class="pre">charisma-env.yml</span></code> file from our CHARISMA Github first, open your Anaconda Prompt, and go to your download directory by typing the following command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="sb">`</span><span class="nb">cd</span><span class="w"> </span>C:/your_download_path/<span class="sb">`</span>
</pre></div>
</div>
<p>To create and activate <cite>charisma-env</cite> with conda, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>charisma-env.yml

conda<span class="w"> </span>activate<span class="w"> </span>charisma-env
</pre></div>
</div>
<p>After creating and activating the <code class="code docutils literal notranslate"><span class="pre">charisma-env</span></code> environment, specify the environment and install (or launch) Jupyter Notebook from Anaconda Navigator to use our CHARISMA Python package.</p>
<img alt="Screenshot of launching the Jupyter Notebook under a specific environment." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/65c52a82-8f65-4a72-aebb-020334b98795" />
<p>Figure: Screenshot of launching the Jupyter Notebook under a specific environment.</p>
</section>
<section id="open-gpr-data-in-dzt">
<h2>Open GPR data in DZT<a class="headerlink" href="#open-gpr-data-in-dzt" title="Link to this heading"></a></h2>
<p>We provide Python code to allow users to read GPR data in DZT format. General users cannot read DZT files if they do not have access to specific software, and there is no way to know how the NDE data is processed to get the results. The <code class="code docutils literal notranslate"><span class="pre">readdzt</span></code> function in our Python code <code class="code docutils literal notranslate"><span class="pre">GPR_locate_rebars.py</span></code> is in charge of opening, reading, and configuring the DZT data into the Pandas DataFrame, and the <code class="code docutils literal notranslate"><span class="pre">save_to_csv</span></code> function exports the DataFrame into CSV format. Here the readers need to define the directory path individually to save the CSV files in your storage system. Here we are saving two CSV files for DataFrame1 <code class="code docutils literal notranslate"><span class="pre">df1</span></code> and DataFrame2 <code class="code docutils literal notranslate"><span class="pre">df2</span></code> from one DZT file. The <cite>df1</cite> is for collected GPR data and <cite>df2</cite> is for the configuration settings of GPR.</p>
</section>
</section>
<section id="chapter-3-gpr-data-from-fhwa-nde-lab-specimen">
<h1>Chapter 3. GPR Data from FHWA NDE Lab Specimen<a class="headerlink" href="#chapter-3-gpr-data-from-fhwa-nde-lab-specimen" title="Link to this heading"></a></h1>
<p>This chapter focuses on elucidating the procedures employed for processing Ground Penetrating Radar (GPR) data obtained from our laboratory specimen (Lin et al. 2018). The structure under examination within our laboratory setting replicates a section of a concrete bridge with embedded reinforcement bars (rebar). Our GPR data processing involves implementing advanced techniques for time-zero correction and F-K migration, ensuring a precise representation of the rebar configuration within the specimen.</p>
<section id="step-1-read-the-saved-csv-files">
<h2>Step 1. Read the saved CSV files<a class="headerlink" href="#step-1-read-the-saved-csv-files" title="Link to this heading"></a></h2>
<p>We read the saved CSV files to process further. Let’s use the <code class="code docutils literal notranslate"><span class="pre">read_csv</span></code> function to define two Pandas DataFrames. After that, we set each row of configuration data <code class="code docutils literal notranslate"><span class="pre">df_2</span></code> as a local variable in Python, using the <code class="code docutils literal notranslate"><span class="pre">config_to_variable</span></code> function.</p>
<p>Let’s investigate the CSV data in detail. The DataFrame1 <code class="code docutils literal notranslate"><span class="pre">df_1</span></code> is actual GPR data (512 Rows × 332 Cols). The 512 rows are the “time” within the investigated underground subsurface, and 332 columns are the number of scans, corresponding to a distinct scan instance where a radar wavelet is emitted and recorded by the antenna while the GPR machine traverses along the survey line.</p>
<p>The DataFrame2 <code class="code docutils literal notranslate"><span class="pre">df_2</span></code> is a configuration setting of GPR machine (24 Rows × 2 Cols). Here we discuss some of the important parameters among them, but readers are redirected to the GPR manufacturer webpage for further details: GSSI SIR 3000 Manual <a class="reference external" href="https://www.geophysical.com/wp-content/uploads/2017/10/GSSI-SIR-3000-Manual.pdf">https://www.geophysical.com/wp-content/uploads/2017/10/GSSI-SIR-3000-Manual.pdf</a>. Here we discuss 7 important parameters in the configuration setting: <code class="code docutils literal notranslate"><span class="pre">rh_nsamp</span></code>, <code class="code docutils literal notranslate"><span class="pre">rhf_sps</span></code>, <code class="code docutils literal notranslate"><span class="pre">rhf_spm</span></code>, <code class="code docutils literal notranslate"><span class="pre">rhf_position</span></code>, <code class="code docutils literal notranslate"><span class="pre">rhf_range</span></code>, <code class="code docutils literal notranslate"><span class="pre">rhf_espr</span></code>, and <code class="code docutils literal notranslate"><span class="pre">rhf_depth</span></code>.</p>
<p>The parameter <code class="code docutils literal notranslate"><span class="pre">rh_nsamp</span></code> represents the number of samples in the depth dimension (equivalent to the 512 Rows). Imagine a grid interface of the underground subsurface to save the wavelet in discrete form (to save as data). The higher number of samples provide higher resolution, but larger size of the data.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">rhf_sps</span></code> and <code class="code docutils literal notranslate"><span class="pre">rhf_spm</span></code> refer to “scans-per-second” and “scans-per-meter”. Here scans mean the column dimension of the GPR data (332 Cols in our data). Both of parameters indicate how many scans are obtained per unit time or distance.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">rhf_position</span></code> and <code class="code docutils literal notranslate"><span class="pre">rhf_range</span></code> are parameters for indicating position and range of the GPR scans in nano seconds (ns). For example, if <code class="code docutils literal notranslate"><span class="pre">rhf_position</span> <span class="pre">=</span> <span class="pre">0</span></code>, this means that the starting point for measuring positions in your GPR data is at the initial time when the radar pulse is sent. In other words, the measurement of positions starts from the moment the radar pulse is emitted. Similarly, if <code class="code docutils literal notranslate"><span class="pre">rhf_range</span> <span class="pre">=</span> <span class="pre">8</span></code>, it indicates the time it takes for the radar signals to travel to the subsurface and return takes 8 ns. By knowing the speed of electromagnetic waves and average dielectric constant, this time can be converted to a depth measurement.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">rhf_espr</span></code> is average dielectric constant. It accounts for the varying properties of the subsurface materials. Different materials have different dielectric constants, and accurate knowledge of this parameter is crucial for correctly interpreting the travel time of radar signals and converting it into depth. Table 1 shows the relative dielectric constant for various materials. The <code class="code docutils literal notranslate"><span class="pre">rhf_depth</span></code> is depth in meters, indicating how deep into the subsurface the radar signals penetrate underground.</p>
</section>
<section id="step-2-time-zero-correction">
<h2>Step 2. Time-zero correction<a class="headerlink" href="#step-2-time-zero-correction" title="Link to this heading"></a></h2>
<p>Time-zero correction aligns multiple A-scans vertically. When the reflected signal is recorded in the receiver, several factors (thermal drift, electronic instability, cable length differences, or variations in antenna airgap) can cause inconsistent wavelet arrival time (Jol 2008). Time-zero correction provides a more accurate depth calculation because it sets the top of the scan to a close approximation of the ground surface (GSSI Inc. 2017). We assume the first positive peak of each A-scan represents the 0 m depth of the ground surface, which is called the “first positive peak” method (Cook et al. 2022)(Yelf 2004).</p>
<img alt="Comparison of (a) before time-zero correction and (b) after scan-by-scan time-zero correction on our GPR data." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/558763e5-ff93-41f4-a056-f9bcf913e8d3" />
<p>Figure 4. Comparison of (a) before time-zero correction and (b) after scan-by-scan time-zero correction on our GPR data.</p>
<p>There are a couple of methods of time-zero correction, one method is calculating the mean or median value of the first peak’s arrival time for the entire A-scans and cut out the data before the mean or median time (Cook et al. 2022). However, this method is not robust since the time-zero position is not perfectly aligned with all the 1st positive peaks of the A-scans (see Figure 5). This method does not correspond with our assumption that the first positive peak of each A-scan represents the 0 m depth of the ground surface.</p>
<img alt="Plots of multiple A-scans with mean value method. The red vertical line shows the time-zero index based on the mean value. Some of the 1st positive peaks of A-scans align with the time-zero, but some A-scans do not." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/03a6088f-0b02-47e2-819b-d9de0ecd277e" />
<p>Figure 5. Plots of multiple A-scans with mean value method. The red vertical line shows the time-zero index based on the mean value. Some of the 1st positive peaks of A-scans align with the time-zero, but some A-scans do not.</p>
<p>The other method is “scan-by-scan” which is more reasonable and robust than the mean or median strategy. This method detects the 1st positive peaks of A-scans and processes them individually. However, since the location of the 1st peak is different from each other, the data length is also changed. For example, one A-scan has 1st positive peak at the 127th depth index, the other has the 130th index, and if we align the data based on the time-zero index, the starting and ending points of A-scans mismatch each other (See Figure 6). Thus, we cut out the data indices that are not in the common range. For example, if one of the A-scan ranges [-125, 386] and the other ranges [-135, 376], we are taking the data only in common so that the range of data indices becomes [-125, 376]. Figure 7 shows the result of our scan-by-scan time-zero correction after the index cut out.</p>
<img alt="Plots of multiple A-scans with scan-by-scan method." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/05d38f89-1285-40c2-a681-a90ea5357318" />
<p>Figure 6. Plots of multiple A-scans with scan-by-scan method. The red vertical line shows the time-zero index, and the 1st positive peak is aligned to the red line. This method results in misalignment at the starting and ending points of the A-scan profiles.</p>
<img alt="Plots containing multiple A-scans using a scan-by-scan approach, with the exclusion of data outside the common range." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/bb5e629b-58c2-49ad-8a06-d7ddea478369" />
<p>Figure 7. Plots containing multiple A-scans using a scan-by-scan approach, with the exclusion of data outside the common range. The red vertical line shows the time-zero index, and the 1st positive peak is aligned to the red line. The misalignment issue at the starting and the ending points of the A-scan profiles is solved.</p>
</section>
<section id="step-3-migration">
<h2>Step 3. Migration<a class="headerlink" href="#step-3-migration" title="Link to this heading"></a></h2>
<p>Migration process converts the hyperbolic signal into spatial locations of the subsurface object. The hyperbolas in the GPR B-scan data stem from the nature of its method. GPR uses electromagnetic wave pulse to detect buried objects, and the antenna is traversing over the survey line. When the antenna is directly above the object, the distance is at its minimum. As the antenna moves, the distance is getting longer. This changing distance results in a distance-time plot that resembles a hyperbola (Figure 8).</p>
<img alt="Schematic of GPR data acquisition process and hyperbola profile formation on the distance-time plot." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/de5d0530-65b3-4939-8a1e-60822e756e15" />
<p>Figure 8. Schematic of GPR data acquisition process and hyperbola profile formation on the distance-time plot. Note that the distance is minimal when the object and antenna are vertically aligned (Poluha et al. 2017).</p>
<p>The hyperbola profiles in B-scan can lead to distortions in the radar image. Migration algorithms help correct these distortions, relocating the reflected signals to their correct positions in the subsurface, resulting in a more accurate representation of the buried features. Here we specifically introduce Frequency-Wavenumber (F-K or Stolt) migration (Stolt 1978). This method has proven to work well for the constant-velocity propagation media (Xu, Miller, and Rappaport 2003)(Özdemir et al. 2014).</p>
<p>The F-K migration transforms the GPR B-scan into an artificially created wave map. In other words, this method specifically locates the object by reconstructing the waveforms at object locations. This is done by the Fourier Transform, converting the waves from the time-space domain to the frequency-wavenumber domain. To understand how this process works, we need the wave propagation equation in a media,</p>
<div class="math notranslate nohighlight">
\[\left( \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial z^2} - \frac{1}{v^2} \frac{\partial^2}{\partial t^2} \right) \phi(x, z, t) = 0,\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\)</span> is the wave function (apparently GPR signals are electromagnetic waves), <span class="math notranslate nohighlight">\(x\)</span> is the axis along the GPR survey line, <span class="math notranslate nohighlight">\(z\)</span> is the axis along the depth, and <span class="math notranslate nohighlight">\(t\)</span> is the time. If you are not familiar with the wave propagation equation in a media, you are redirected to the following YouTube video, which derives the wave equation from scratch with the guitar (acoustic wave): <a class="reference external" href="https://www.youtube.com/watch?v=UXqUXYaRyGU&amp;t=1684s&amp;ab_channel=SteveBrunton">https://www.youtube.com/watch?v=UXqUXYaRyGU&amp;t=1684s&amp;ab_channel=SteveBrunton</a></p>
<p>The next step is applying the inverse Fourier transform to the wave function <span class="math notranslate nohighlight">\(\phi(x, z, t)\)</span>,</p>
<div class="math notranslate nohighlight">
\[\phi(x, z, t) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} E(k_x, \omega) e^{-j(k_x x + k_z z - \omega t)} \ dk_x \ d\omega\]</div>
<p>where <span class="math notranslate nohighlight">\(E(k_x, \omega)\)</span> is the Fourier domain for every possible combination of wave number <span class="math notranslate nohighlight">\(k_x\)</span> and frequency <span class="math notranslate nohighlight">\(\omega\)</span>. The physical meaning of the equation is that the wave function can be expressed as a summation of various plane waves with different wavenumbers and frequencies. It is noteworthy that the <span class="math notranslate nohighlight">\(E(k_x, \omega)\)</span> is time-independent, which will be used to relocate the waveform at the specific location of the object underground (The meaning of “migration” comes from this aspect).</p>
<p>After the inverse Fourier transform, we correlate our actual GPR data into the equation. Note that we receive GPR signal at <span class="math notranslate nohighlight">\(z = 0\)</span>, where the antenna locations are at the surface. Then the wave function becomes,</p>
<div class="math notranslate nohighlight">
\[\phi(x, z=0, t) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} E(k_x, \omega) e^{-j(k_x x - \omega t)} \ dk_x \ d\omega.\]</div>
<p>This equation can transform the GPR signals into the frequency-wavenumber domain. To reconstruct the wave function, we need to know the <span class="math notranslate nohighlight">\(E(k_x, \omega)\)</span>. <span class="math notranslate nohighlight">\(E(k_x, \omega)\)</span> is obtained by Fourier transform and our GPR signal,</p>
<div class="math notranslate nohighlight">
\[E(k_x, \omega) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \phi(x, z=0, t) e^{j(k_x x - \omega t)} \ dx \ dt.\]</div>
<p>Now, the equation is formulated to construct our parameter <span class="math notranslate nohighlight">\(E(k_x, \omega)\)</span> based on the GPR data. We will employ the Exploding Source Modeling (ESM), which straightforwardly assumes that the reflected GPR wave originates directly from the object itself. This assumption allows us to express our reconstructed signal (the migrated image) as <span class="math notranslate nohighlight">\(\phi(x, z, t = 0)\)</span>, where <span class="math notranslate nohighlight">\(t = 0\)</span> signifies the initial waveform at the object. At this point, we successfully correlated the GPR signal <span class="math notranslate nohighlight">\(\phi(x, z = 0, t)\)</span> with the Fourier domain <span class="math notranslate nohighlight">\(E(k_x, \omega)\)</span>, and this <span class="math notranslate nohighlight">\(E(k_x, \omega)\)</span> is again correlated to the wavefunction at the object <span class="math notranslate nohighlight">\(\phi(x, z, t = 0)\)</span>. This is the main logic of the F-K migration.</p>
<p>It’s crucial to emphasize that this assumption holds true only when the data is time-zeroed, as our consideration of the time frame extends from the object to the surface. As previously mentioned, the time-zero correction assumes that we interpret the first positive peak as the surface reflection, and without time-zero, the time frame extends beyond the object to the surface when setting <span class="math notranslate nohighlight">\(t = 0\)</span> at the object.</p>
<p>Another crucial aspect of ESM is the elimination of the <span class="math notranslate nohighlight">\(-\omega t\)</span>  term in the equation. This modification enables us to employ the Fast Fourier Transform for wavefunction reconstruction. By removing the time-dependent term from the exponential part, the equation becomes more numerically manageable. Our final mathematical representation of F-K migration is as follows,</p>
<div class="math notranslate nohighlight">
\[\phi(x, z, t=0) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} E(k_x, \omega) e^{-j(k_x x + k_z z)} \ dk_x \ d\omega.\]</div>
<p>In our Python code, we discretize the wave function at the surface (GPR signal) <span class="math notranslate nohighlight">\(\phi(x, z = 0, t)\)</span> as a matrix, and then solve the equations above numerically (through fast Fourier transform) to reconstruct the wave function at <span class="math notranslate nohighlight">\(t = 0\)</span>, <span class="math notranslate nohighlight">\(\phi(x, z, t = 0)\)</span> based on <span class="math notranslate nohighlight">\(E(k_x, \omega)\)</span>. Figure 9 shows the migration results from the mean, and scan-by-scan time zero correction, respectively. Instead of the hyperbola profiles in the raw GPR B-scan data, there are some points with high amplitude (white dots in Figure 9). These points indicate the rebar locations underground.</p>
<img alt="F-K migration results" src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/a5e65925-b51b-46a7-b3bf-60ecbdfc9c24" />
<p>Figure 9. F-K migration results from the (a) mean time-zero correction and (b) scan-by-scan time-zero correction.</p>
</section>
<section id="step-4-pinpoint-rebars">
<h2>Step 4. Pinpoint Rebars<a class="headerlink" href="#step-4-pinpoint-rebars" title="Link to this heading"></a></h2>
<p>It is noteworthy that the size of the white points in Figure 9 are too large compared to the actual rebar diameter, so we estimate the rebar location with the K-means clustering method. K-means clustering is a popular unsupervised machine learning algorithm used for partitioning a dataset into distinct, non-overlapping clusters. The goal is to group similar data points together and separate dissimilar ones. Interesting features in K-means clustering are that 1) we can specify the number of clusters we want to observe, and 2) we can point out the centroid of each cluster. We take advantage of these features to pinpoint the rebar location.</p>
<p>Our code normalizes the signal amplitude of the migrated data frame from -1 to 1, gets all the data points where the amplitudes are above 0.7. This allows us to get all the white data points to form a cluster around the white locations. Since we know the number of white points, we apply the K-means clustering algorithm to identify the <span class="math notranslate nohighlight">\((x, z)\)</span> coordinates of each centroid of the cluster. In this case study, we want to compare the located results between the two time-zero correction methods. Figure 10 shows the estimated rebar location from the mean, and scan-by-scan time zero correction, respectively. Figure 11 shows the differences in these two cases, with the root mean squared error (RMSE) value of 0.101 inches. We confirmed that the scan-by-scan method is more accurate than the mean time-zero correction for our rebar locating algorithm since the latter method slightly overestimates the depth of the rebar.</p>
<img alt="Estimated rebar location from the (a) mean and (b) scan-by-scan time-zero correction." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/b820aff2-86d0-4815-9371-42acfb1ecd7f" />
<p>Figure 10. Estimated rebar location from the (a) mean and (b) scan-by-scan time-zero correction.</p>
<img alt="Estimated rebar location from the (a) mean and (b) scan-by-scan time-zero correction." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/869d90f1-9c93-4ceb-8a58-2b5945ea5ce4" />
<p>Figure 11. Rebar location difference between the mean time-zero and scan-by-scan time-zero correction.</p>
</section>
<section id="step-5-discussion">
<h2>Step 5. Discussion<a class="headerlink" href="#step-5-discussion" title="Link to this heading"></a></h2>
<p>With the precise rebar configuration identified in our lab specimen through time-zero correction and F-K migration techniques, we have established a solid foundation for our data analysis. The remarkably clean nature of the lab specimen data has allowed us to bypass the need for additional processing steps like gain or dewow adjustments.</p>
<p>As we move forward, a crucial step in validating the robustness of our methodology is to apply it to GPR data acquired from an actual bridge. Real-world scenarios often present unique challenges that may not be fully replicated in a controlled laboratory environment. To ensure the reliability and applicability of our method, the next chapter shows how we process GPR data collected from the bridge structure.</p>
</section>
</section>
<section id="chapter-4-gpr-data-from-fhwa-infobridge">
<h1>Chapter 4. GPR Data from FHWA InfoBridge™<a class="headerlink" href="#chapter-4-gpr-data-from-fhwa-infobridge" title="Link to this heading"></a></h1>
<p>FHWA InfoBridge™ provides field data collections using various NDE technologies, including GPR (<a class="reference external" href="https://infobridge.fhwa.dot.gov/Data">https://infobridge.fhwa.dot.gov/Data</a>). We selected a bridge from Mississippi to illustrate the use of CHARISMA for rebar identification (Structure number: 11000100240460B). The bridge name is I-10 over CEDAR LAKE ROAD, built-in 1970. The bridge type is a Prestressed Concrete Girder/Beam. The length of the bridge is 242.50 and the width is 59.40 ft, respectively.</p>
<img alt="Screenshot of obtaining GPR data from FHWA InfoBridge™." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/fed8bd45-d4e1-41e9-ab38-65e1876b3bed" />
<p>Figure 12. Screenshot of obtaining GPR data from FHWA InfoBridge™. Follow the URL, select the bridge, and scroll down to click LTBP. Then you can select the Download files to download the NDE data.</p>
<img alt="Bridge location map of I-10 over CEDAR LAKE ROAD in Mississippi." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/9e7d0b1b-6db5-4f10-a470-4ff4dc72808b" />
<p>Figure 13. Bridge location map of I-10 over CEDAR LAKE ROAD in Mississippi.</p>
<section id="step-1-outlier-control-via-interquartile-range-iqr-method">
<h2>Step 1. Outlier control via interquartile range (IQR) method<a class="headerlink" href="#step-1-outlier-control-via-interquartile-range-iqr-method" title="Link to this heading"></a></h2>
<p>With the same <code class="code docutils literal notranslate"><span class="pre">read_csv</span></code> function from the previous chapter, we are making 2 Pandas DataFrames: GPR data and configuration. We noticed that there are some outlier values on the GPR data, so we removed them by the interquartile range (IQR) method. The IQR method is a statistical technique used to identify and remove outliers from a dataset. It involves calculating the range between the first quartile (Q1) and the third quartile (Q3) of the data distribution. Outliers are then identified and removed based on a specified multiplier of the IQR. This method is effective in addressing skewed or non-normally distributed data by focusing on the central portion of the dataset. A more detailed explanation is in our code description of the <code class="code docutils literal notranslate"><span class="pre">Interquartile_Range</span></code>.</p>
<img alt="Outlier control with IQR method." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/841a406e-69d9-4f67-a6f4-0f3b8acf393a" />
<p>Figure 14. Outlier control with IQR method. The <code class="code docutils literal notranslate"><span class="pre">df_1</span></code> is the raw data and the <code class="code docutils literal notranslate"><span class="pre">IQR_df_1</span></code> is the processed data. The red boxs show how the outlier value changed.</p>
</section>
<section id="step-2-gain">
<h2>Step 2. Gain<a class="headerlink" href="#step-2-gain" title="Link to this heading"></a></h2>
<p>We observed that the GPR signal isn’t sufficiently clear for processing (see Figure 16 (a) and (c)), likely because the first peak amplitude significantly outweighs other signals. This disparity could be attributed to the GPR settings or signal attenuation. To address this issue, we employ a gain function to better highlight the reflected signal. We introduce two methods, namely power gain and exponential gain (Huber and Hans 2018), to enhance the clarity of the reflected signal. The power gain function is defined as follows,</p>
<div class="math notranslate nohighlight">
\[x_g(t) = x(t) \cdot t^{\alpha}.\]</div>
<p>The signal <span class="math notranslate nohighlight">\(x(t)\)</span> is multiplied by <span class="math notranslate nohighlight">\(t^{\alpha}\)</span>, where <span class="math notranslate nohighlight">\(\alpha\)</span> is the exponent. In the default case, <span class="math notranslate nohighlight">\(\alpha\)</span> is set to 1. The effect of the power gain is to amplify the signal based on a power-law relationship with time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>The exponential gain function is defined as,</p>
<div class="math notranslate nohighlight">
\[x_g(t) = x(t) \cdot \exp(\alpha \cdot t).\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\exp(\alpha \cdot t)\)</span> represents the exponential function with <span class="math notranslate nohighlight">\(\alpha\)</span> as the exponent. The signal <span class="math notranslate nohighlight">\(x(t)\)</span> is multiplied by this exponential term. The exponential gain introduces a time-dependent exponential factor to the signal. Adjusting the <span class="math notranslate nohighlight">\(\alpha\)</span> parameter allows control over the rate of amplification, impacting the signal characteristics. We applied the power gain function with <span class="math notranslate nohighlight">\(\alpha = 0.2\)</span> only after the initial positive and negative peaks for improved visibility and processing.</p>
<img alt="A-scan of the GPR data (a) before gain and (b) after gain" src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/ebda4d59-3b52-4dbb-90b7-9349ce6cd697" />
<p>Figure 15. A-scan of the GPR data (a) before gain and (b) after gain. The first peak in (a) is much larger than the other signals, making the B-scan image blur. Note that the base line of the signal in (b) is going upward, due to the amplification.</p>
<img alt="B-scan of the GPR data (a) &amp; (c) before gain and (b) &amp; (d) after gain." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/d9f75034-493e-44a8-9766-813fcdaddb99" />
<p>Figure 16. B-scan of the GPR data (a) &amp; (c) before gain and (b) &amp; (d) after gain.</p>
</section>
<section id="step-3-dewow">
<h2>Step 3. Dewow<a class="headerlink" href="#step-3-dewow" title="Link to this heading"></a></h2>
<p>Dewow is used to mitigate the effects of low-frequency variations, or “wows,” in the GPR signal. The terminology is derived from the nature of the low-frequency variations or oscillations that it aims to mitigate—resembling a slow, undulating motion, akin to the exclamation “wow.” Wows can result from various factors, such as uneven ground surfaces or fluctuations in the system. Dewow processing involves filtering or removing these low-frequency components from the GPR signal to enhance the clarity and resolution of subsurface features. This technique helps improve the overall quality of GPR data by reducing unwanted variations. Here we used trinomial dewow (Nesbitt et al. 2022) to correct the baseline of each A-scan.</p>
<img alt="A-scan of the GPR data (a) before dewow and (b) after dewow." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/b4795435-f0d5-424a-b121-d7a201f7b7df" />
<p>Figure 17. A-scan of the GPR data (a) before dewow and (b) after dewow. The baseline of the A-scan is corrected.</p>
<img alt="B-scan of the GPR data (a) &amp; (c) before dewow and (b) &amp; (d) after dewow." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/4bb46b37-8888-4d32-9704-3c9fe2633e1c" />
<p>Figure 18. B-scan of the GPR data (a) &amp; (c) before dewow and (b) &amp; (d) after dewow.</p>
</section>
<section id="step-4-time-zero-correction">
<h2>Step 4. Time-Zero Correction<a class="headerlink" href="#step-4-time-zero-correction" title="Link to this heading"></a></h2>
<p>With the processed data, we are applying the scan-by-scan time-zero correction.</p>
<img alt="The results of the scan-by-scan time-zero correction." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/7cfbbbdb-abe3-425d-b71c-495e20cc7fe5" />
<p>Figure 19. Scan-by-scan time-zero correction results.</p>
</section>
<section id="step-5-migration">
<h2>Step 5. Migration<a class="headerlink" href="#step-5-migration" title="Link to this heading"></a></h2>
<p>We apply F-K migration based on the time-zeroed data.</p>
<img alt="The results of the F-K migration." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/a4bb2ef6-57a0-4023-a41c-f76a2034fc5d" />
<p>Figure 20. F-K migration results.</p>
</section>
<section id="step-6-pinpoint-rebars">
<h2>Step 6. Pinpoint Rebars<a class="headerlink" href="#step-6-pinpoint-rebars" title="Link to this heading"></a></h2>
<p>We use the K-means clustering algorithm used in the previous chapter to pinpoint rebar locations.</p>
<img alt="The estimated rebar locations." src="https://github.com/TFHRCFASTNDElab/CHARISMA/assets/154364860/0e6e54d1-e78c-4555-887b-3b9c8d7b62f4" />
<p>Figure 21. The estimated rebar locations.</p>
</section>
<section id="step-7-discussion">
<h2>Step 7. Discussion<a class="headerlink" href="#step-7-discussion" title="Link to this heading"></a></h2>
<p>Compared to Lab specimens, we encountered a few challenges: firstly, the GPR data had some outliers with very high negative values (400 times larger than the 1st negative peak). Secondly, the amplitude of the 1st positive and negative peak outweighs the reflected signal, showing very unclear results. Lastly, the dielectric constant was not inputted correctly when the data was collected. This resulted in inaccurate migration results, so we estimated the dielectric based on the migration results.</p>
<p><strong>How do we use CHARISMA to solve the problem?</strong></p>
<p>We successfully processed the actual concrete bridge GPR data by processing the outliers with IQR, applying gain to amplify the reflection signals, adjusting the A-scan baseline with dewow, leveraging the scan-by-scan time-zero correction, F-K migration, and K-means clustering algorithm to pinpoint the rebar locations. It is noteworthy that GPR data processing requires a deep understanding of each data processing method, and the workers should be able to adjust or apply variables or types of the function with respect to the data characteristics.</p>
<p><strong>What limitations have been reminded of?</strong></p>
<p>The limitation to our work lies in the F-K migration. It requires the dielectric to be constant for all media, which is hard to assume. Notably, the approximate dielectric value used in F-K migration is from the GPR configuration settings, which are defined by the user. This means if the actual data collector sets the value as default, the migration results can be significantly distorted or underestimated. We are currently working on how to automate to determine the dielectric based only on the migration results.</p>
</section>
</section>
<section id="chapter-5-references">
<h1>Chapter 5. References<a class="headerlink" href="#chapter-5-references" title="Link to this heading"></a></h1>
<p>Cook, Samantha N et al. 2022. “Automated Ground-Penetrating-Radar Post-Processing Software in R Programming.”</p>
<p>Huber, Emanuel, and Guillaume Hans. 2018. “RGPR—An Open-Source Package to Process and Visualize GPR Data.” In 2018 17th International Conference on Ground Penetrating Radar (GPR), IEEE, 1–4.</p>
<p>GSSI (Geophysical Survey Systems). Inc. 2017. “RADAN 7 Manual.”</p>
<p>Jol, Harry M. 2008. Ground Penetrating Radar Theory and Applications. elsevier.</p>
<p>Lin, Shibin et al. 2018. “Laboratory Assessment of Nine Methods for Nondestructive Evaluation of Concrete Bridge Decks with Overlays.” Construction and Building Materials 188: 966–82.</p>
<p>Merkle, Dominik, Carsten Frey, and Alexander Reiterer. 2021. “Fusion of Ground Penetrating Radar and Laser Scanning for Infrastructure Mapping.” Journal of Applied Geodesy 15(1): 31–45.</p>
<p>Nesbitt, Ian et al. 2022. “Readgssi: An Open-Source Tool to Read and Plot GSSI Ground-Penetrating Radar Data.” <a class="reference external" href="https://doi.org/10.5281/zenodo.5932420">https://doi.org/10.5281/zenodo.5932420</a>.</p>
<p>Özdemir, Caner, Şevket Demirci, Enes Yiǧit, and Betül Yilmaz. 2014. “A Review on Migration Methods in B-Scan Ground Penetrating Radar Imaging.” Mathematical Problems in Engineering 2014.</p>
<p>Poluha, Bruno et al. 2017. “Depth Estimates of Buried Utility Systems Using the GPR Method: Studies at the IAG/USP Geophysics Test Site.” International Journal of Geosciences 08(05): 726–42.</p>
<p>Stolt, R. H. 1978. “Migration By Fourier Transform.” Geophysics 43(1): 23–48.</p>
<p>Xu, Xiaoyin, Eric L. Miller, and Carey M. Rappaport. 2003. “Minimum Entropy Regularization in Frequency-Wavenumber Migration to Localize Subsurface Objects.” IEEE Transactions on Geoscience and Remote Sensing 41(8): 1804–12.</p>
<p>Yelf, Richard. 2004. “Where Is True Time Zero?” Proceedings of the Tenth International Conference Ground Penetrating Radar, GPR 2004 1(February 2004): 279–82.</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Federal Highway Administration (FHWA).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>